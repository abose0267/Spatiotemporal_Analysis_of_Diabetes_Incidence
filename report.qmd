---
title: "The Positive Relationship of Walkability on Diabetes Prevalence in the Southern United States"
format:
  arxiv-pdf:
    keep-tex: true  
    linenumbers: true
    doublespacing: true
    runninghead: "A Preprint"
  arxiv-html: default
author:
  - name: Arkaprabho Bose
    affiliations:
      - name: Texas A & M University
        department: Undergraduate Program in Department of Computer Science
        address: 400 Bizzell Street
        city: College Station, TX
        country: USA
        postal-code: 77843
    email: abose0267@tamu.edu
  - name: Sebastian Oberg
    affiliations:
      - name: Texas A & M University
        department: Undergraduate Program in Department of Computer Science
        address: 400 Bizzell Street
        city: College Station, TX
        country: USA
        postal-code: 77843
  - name: Abhinav Cheruvu
    affiliations:
      - name: Texas A & M University
        department: Undergraduate Program in Department of Mathematics
        address: 400 Bizzell Street
        city: College Station, TX
        country: USA
        postal-code: 77843
abstract: |
  The diabetes epidemic in the United States presents a nuanced public health challenge, influenced by factors such as socioeconomic status and climate. While the impact of these factors is well-documented, the influence of walkability on diabetes prevalence has been underexplored. This study investigates how both socioeconomic and climate variables, alongside walkability, affect diabetes prevalence in the Southern U.S. Contrary to expectations, our findings indicate that higher walkability indexes correlate with an increase in diabetes prevalence. This effect persists even when controlling for high blood pressure and low physical activity, which indicates significant regional variance. Our findings show that the relationship between walkability and diabetes prevalence varies significantly by region, driven by distinct socioeconomic and environmental contexts. This variability highlights the need for urban planning as a public health strategy that is tailored to the specific regional characteristics to effectively address diabetes.
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(warning = FALSE)
```
```{r,results='hide',message=FALSE, warning=FALSE}
source("./Functions/DataProcessing.R")

library(GWmodel)
library(ggplot2)
library(dplyr)
library(ggplot2)
library(sf)
library(tidyverse)
library(corrplot)
source("data/artificialData.R")
source("analysis/gwrAnalysis.R")
set.seed(123)
```

```{r echo={FALSE}, results='hide',message=FALSE, warning=FALSE}
loadedData <- loadData()
```

```{r echo={FALSE}, results = 'hide',message=FALSE}
cleaned_walkability = loadedData$original_walkability %>% clean_walkability()
cleaned_diabetes = loadedData$original_diabetes %>% clean_diabetes()
spatial_data = loadedData$spatial_data %>% clean_spatial()
temp_data = loadedData$temp_data %>% cleaned_weather()
income_data = loadedData$income_data %>% clean_income()
new_dataset = merge(cleaned_walkability, cleaned_diabetes, by = "CountyFIPS", all.x = TRUE, all.y = TRUE) %>% subset( !(StateAbbr %in% c("AK", "HI"))) %>% merge(temp_data, by = "CountyFIPS", all.x = TRUE, all.y = TRUE)
merged_income = merge(new_dataset,income_data,by = "CountyFIPS", all.x = TRUE, all.y = TRUE ) %>% na.omit()
new_spatial_dataset = merge(merged_income,spatial_data, by = "CountyFIPS", all.x = TRUE, all.y = TRUE) %>% na.omit()

summary(new_spatial_dataset)
```


# Introduction {#sec-intro}

Diabetes is a common chronic illness that is caused due to consistently high blood sugar levels, and can be prevented through sugar intake management, exercise and dieting. In a study done on 2016 and 2017 National Center for Health Statistics data, it was shown that among adults in the United States, there was a prevalence of 9.7% (Xu, et. al). This high prevalence can impact humans on a daily basis by directly impacting the quality of life both physically and mentally. Diabetes can affect organs all around the body such as the eyes, pancreas and kidneys. In addition to having direct impact on people, high prevalence of diabetes puts stress on the existing healthcare systems by forcing hospitals and doctors to put resources into solving issues that are preventable.

In recent years, there have been speculations that lifestyle changes, specifically walkability of a region can impact the prevalence of diabetes in that given region. The Environmental Protection Agency has developed a standardized scale on which regions can be ranked based on how walkable it is. The scale ranges from 1-20 with 1 being the least walkable and 20 being the most walkable. It takes into account various things such as intersection density, and proximity to transit (Glazier et al.). According to a temporal analysis study done in 2016, areas with highest walkability score, which is a value calculated  had lower rates of diabetes prevalence (Creatore et. al). An area being walkable results in less reliance on cars, and forces the population to walk which is a form of exercise that is often overlooked and can have a meaningful impact on ones health.

The study mentioned above by Creatore was done at a city level, where a lot of geographic factors
are consistent across the entire study area. That brings up the question of whether the trend that was found in Creatore's study would hold across the United States. Our study shows that taking into account health and socioeconomic factors, the trend is inconsistent and that there is a positive correlation between a region's walkability score and its diabetes prevalence in the southern regions of the United States, which is the opposite of the result found in Creatore's study. There must be underlying geographic factors that contribute to this unexpected observation.

It is crucial to understand this relationship, so that the correct actions can be taken to decrease the prevalence of diabetes in the necessary regions. If regions are showing positive correlation between the two variables, that would suggest that the walkability of the region is not doing enough to decrease the prevalence of diabetes, and they need to either increase the walkability of an area or implement other preventative measures.


# Related Works


## Exploring how location affects diabetes risk, focusing on two studies

Geographical and environmental factors significantly influence the risk and prevalence of diabetes, emphasizing the importance of location in epidemiological studies. This observation sets the stage for a deeper exploration of key studies that analyze how local variables can affect health outcomes. Such studies help highlight the complex interaction between environment and disease, providing a significant context for our research on walkability and diabetes in the United States.


## Study on socio-economic impact in Northeastern Germany

A detailed analysis of a study conducted in Northeastern Germany reveals that socio-economic status significantly impacts diabetes risk within this specific locale (Smith et al., 2020). The research found a noticeable inconsistency in diabetes prevalence correlating with variations in income levels and education, suggesting that socio-economic factors are critical determinants of health. This study emphasizes the importance of considering local factors when assessing diabetes risk and forms a crucial reference point for understanding regional differences in disease prevalence.


## Link between diabetes, obesity, and inactivity

Another significant study examines the correlation between diabetes prevalence, obesity, and physical inactivity, highlighting the necessity for location-specific health solutions (Jones and Taylor, 2019). This research emphasizes the localized nature of diabetes risk factors, demonstrating that areas with higher rates of physical inactivity and obesity tend to have correspondingly higher rates of diabetes. Importantly, the study found that these correlations vary significantly from one community to another, influenced by urban versus rural settings and the availability of recreational facilities. The findings underscore the importance of understanding local health behaviors and lifestyle factors in crafting targeted interventions, suggesting that strategies effective in one region may not be as effective in another due to these vulnerabilities.


## Application of insights to the Southern U.S.

The insights gained from the studies mentioned above inform our examination of how walkability affects diabetes prevalence in the Southern United States. By analyzing the influence of socio-economic and lifestyle factors on diabetes in different regions, we hypothesize that walkability may have a similarly multifaceted impact in the Southern U.S. This framework allows us to test if higher walkability indices typically lead to lower diabetes prevalence or if unique regional factors create different results.



# Methods

## Data and Cleaning

In order to get a better understanding of the topic at hand, a study was performed using data from a few different sources. The walkability index data was from the Environment Protection Agency, using data from 2023. The health factors data was provided by the Center for Disease Control and Prevention, which was last updated in 2023. Small area income and poverty estimates from the United States Census Bureau  was used to get median household income data. Temperature and climate data was from GIS for Racial Equity. All of these datasets were thorough and cleaned with very few missing values. The data was cleaned and the relevant values were put into a new common dataset.

## Relevant Values

Diabetes as a disease has been studied extensively in the past, and as a result there is evidence of numerous factors being correlated to the prevalence of diabetes in the United States. According to a study done by Lazar, obesity can cause inflammations which can be a direct cause for diabetes (Lazar). Other relevant covariates that were picked were low physical activity, high blood pressure, median household income and walkability index. By choosing health risk factors and socioeconomic factors as the covariates, we are removing health factors from causing anomalies in the data, and help our model take those values into account when fitting the data.


## Correlation Matrix

In order to get a general understanding of the data at hand, a correlation matrix was generated to see the relationships between each of the variables. This was also used as a test for multicolinearity. In the case of our project, we used a threshold of 0.8 to find variables with concerning similarities, and depending on the values in the correlation matrix, conducted further analysis to ensure that the values that were similar were not impacting the results of the model heavily.

## Variance Inflation Factor


## Spatial Analysis
Based on the type of the data that was available, it was clear that doing spatial analysis would provide the best results in terms of identifying diabetes patterns across the United States, and how that prevalence can be decreased with walkable areas. The model that was used in this study the a georaphically weighted regression model from the GWModel package in R. This model was chonen for a variety reasons. This model, originally created by Brunsdon, is based on the formula $$y_i = \alpha_{0} + \sum_{k=1}^{m} \alpha_{ik}x_{ik} + \varepsilon_{i}$$ (Brunsdon et. al). This model was chosen for this specific problem because it is able to improve on regular regression models like global regression, and account for spatial heterogeneity. In the case of our data, county level data exhibits spatial heterogeneity due to how small the counties are relative to the size of the United States.



## Adjusting P Values for Significance

Once the model was fit, it was important to adjust the P-values to deal with insignificant coefficients to make the visualization of the results more intuitive. By using the gwr.t.adjust() model in the GWModel package, the p-values were adjusted using the Fotheringham-Byrne procedures. This procedure has been thoruoghly investigated before, and therefore did not require any extra validation (Byrne et. al). Once this process was completed, p-values that were less than 0.05 were considered to be significant, and otherwise was set to 0 for plotting purposes.


## Validation

  A couple different methods were used to test the effectiveness of the geographically weighted regression model 
  
### Simulation Study
  A simulation study was conducted by creating an artificial dataset and putting it through the geographically weighted regression model to see if we could achieve similar results. In order to create the artificial data, we used the covariance matrix of the response and all the covariates from the original data set to understand the underlying relationships, and then used "rmvnorm" from the "mvtnorm" package to generate a dataset with similar covariances centered at the mean value of the original data. The results of the GWR on this artifical data were then compared to the results of the GWR on the real dataset to do validation
  
### Diagnostics

In order to check to make sure our model results were accurate, we used the gwr.collin.diagno() function to test the variance inflation factor of the coefficient estimates. 






```{r message=FALSE, results='hide'}


# Generate data
artificial_data = create_data(new_spatial_dataset)

# Convert data to spatial format and fit GWR
gwr_results <- fit_artificial_gwr(artificial_data)


```







# Results

The simulation study using artificial data demonstrates the strength of our model. Our analysis of simulated data using a GWR model provided valid estimates and coefficients for prediction shown below. In addition, the model’s R-squared value was low with fairly evenly dispersed residuals, making it a reliable benchmark for comparison.

```{r}
# Output results (handle as needed)
as.table(gwr_results$lm$coefficients)
as.table(gwr_results$GW.diagnostic$gw.R2)
```

Examining the GWR model with real-world data revealed a clear positive correlation between walkability and diabetes prevalence, which was particularly notable in the southern United States. Visual representations as seen in the impact plot  highlighted this relationship, with the southern to southeastern regions showing higher walkability's impact on diabetes prevalence, depicted in shades of red. Conversely, contrasting trends were observed in other parts of the country, indicating a negative association between walkability and diabetes.

![](impact_plot.png ""){fig-align="center"}

The correlation between walkability and diabetes prevalence in the South can be attributed to various factors, with higher temperatures emerging as a key consideration. In warmer climates, such as those prevalent in the South, the positive relationship between walkability and diabetes may be influenced by people spending more time indoors to avoid the heat. This reduction in outdoor activity diminishes walkability and could potentially contribute to higher diabetes rates.

Conversely, in colder regions like the west coast and the Pacific Northwest, the impact of walkability on diabetes prevalence appears to be negative, as depicted in the plot. This suggests that regional differences, including climate variations, play a significant role in shaping the relationship between walkability and diabetes.


Moreover, the analysis identified various additional risk factors, notably health-related ones, contributing to elevated diabetes prevalence nationwide. From the facet plot, factors like smoking and obesity showed clear associations with higher rates of diabetes, as expected given their impact on overall health and predisposition to chronic conditions like diabetes.

![](facet_plot.png "Figure 2: Impact of Covariates on Diabetes Prevalence"){fig-align="center"}

In addition, the appendix below provides a comprehensive assessment supporting the accuracy of our model's metrics. The residual plot shows a fairly evenly scattered distribution of predicted values around zero, indicating a well-fitted model. Additionally, the examination for multicollinearity yielded reassuring results, with none of the covariates exhibiting significantly high variance inflation factors (VIF), confirming the absence of multicollinearity issues within our model.

In summary, the insights from our model, both from simulated and real-world data, shed light on the complex interplay between walkability, various risk factors, and diabetes prevalence across different regions. The consistency between metrics obtained from our simulation study and real data, coupled with the absence of multicollinearity issues, underscores the reliability and validity of our findings, supporting the robustness of our approach.



```{r echo={FALSE}, results='hide',message=FALSE, warning=FALSE}
plot_correlation_matrix(merged_income)
```

```{r echo={FALSE}, results='hide',message=FALSE}
new_spatial_dataset <- na.omit(new_spatial_dataset)
sf_spatial_data<- st_as_sf(new_spatial_dataset)
sf_spatial_data <- as(sf_spatial_data, "Spatial")
```


```{r echo={FALSE}, results='hide'}
plot<- ggplot() +
  geom_sf(data = new_spatial_dataset, aes(geometry = geometry,fill = DIABETES_CrudePrev), color="black",size=0.2) +
  scale_fill_viridis_c(name = "Diabetes Crude Prev") +
  labs(title = "Spatial Distribution of Diabetes Crude Prevalence")

ggsave("original_diabetes_plot.png", plot, width = 4, height = 2, units = "in", dpi = 300)
```


```{r , results='hide',message=FALSE,echo={FALSE}}
gwr_model_results = fit_gwr(sf_spatial_data)
# gwr_model_results
```

```{r}
as.table(gwr_model_results$lm$coefficients)
```



```{r echo={FALSE},results='hide'}
val<-gwr.collin.diagno(DIABETES_CrudePrev ~ NatWalkInd + OBESITY_CrudePrev + BPHIGH_CrudePrev + LPA_CrudePrev + CSMOKING_CrudePrev + Median.Household.Income + avg_temp, sf_spatial_data, gwr_model_results$GW.arguments$bw, kernel="exponential",adaptive=FALSE)
```


```{r echo={FALSE} , results='hide'}
adjusted_tvalues <- gwr.t.adjust(gwr_model_results)$SDF %>% as("sf") 
selected_columns <- c(grep("_p$", colnames(adjusted_tvalues), value = TRUE),"geometry")
subset_df <- adjusted_tvalues[, selected_columns]
model_df <- gwr_model_results$SDF %>% as("sf")
for (i in seq_len(nrow(model_df))) {
  # Check values in subset_df
  for (col_name in names(model_df)) {
    # Construct the corresponding column name in subset_df
    col_name_subset <- paste0(col_name, "_p")
    
    # Check if the column exists in subset_df
    if (col_name_subset %in% names(subset_df)) {
      if (subset_df[[col_name_subset]][i] < 0.05) {
        # Set corresponding value in model_df to 0
        model_df[i, col_name] <- 0
      }
    }
  }
}
```

```{r echo=FALSE, , results='hide'}

png("residual_plot.png")
plot(model_df$residual)
dev.off()

```



```{r echo={FALSE}, results='hide'}
plots = data.frame(CountyFIPS = new_spatial_dataset$CountyFIPS,Walkability_Obs = new_spatial_dataset$NatWalkInd,HBP_Obs = new_spatial_dataset$BPHIGH_CrudePrev,walkability_coef= model_df$NatWalkInd, income_impact = new_spatial_dataset$Median.Household.Income * model_df$Median.Household.Income,temp_impact = new_spatial_dataset$avg_temp * model_df$avg_temp, walk_impact = new_spatial_dataset$NatWalkInd * model_df$NatWalkInd, bp_impact = new_spatial_dataset$BPHIGH_CrudePrev * model_df$BPHIGH_CrudePrev, lpa_impact = new_spatial_dataset$LPA_CrudePrev*model_df$LPA_CrudePrev,obesity_impact=new_spatial_dataset$OBESITY_CrudePrev * model_df$OBESITY_CrudePrev, smoking_impact = new_spatial_dataset$CSMOKING_CrudePrev * model_df$CSMOKING_CrudePrev, INTPTLAT=new_spatial_dataset$INTPTLAT, INTPTLON = new_spatial_dataset$INTPTLON, geometry =  new_spatial_dataset$geometry  ) %>%   pivot_longer(cols = c(bp_impact,lpa_impact,smoking_impact,obesity_impact, income_impact, temp_impact),
               names_to = "Impact_Type",
               values_to = "Impact_Value") %>%
  st_sf()


plot1 <- plots %>%
  ggplot() +
  geom_sf(aes(fill = Impact_Value), color = scales::alpha("black", 0.1), ) +
  scale_fill_gradient2(low = "blue", mid = "white", high = "red", midpoint = 0) +
  labs(title = "Estimated Impact of Covariates") +
  facet_wrap(~Impact_Type) 

ggsave("facet_plot.png", plot1, width = 8, height = 6, units = "in", dpi = 300)


plot2 <- plots %>%
  ggplot() +
  geom_sf(aes(fill = walk_impact), color = "black") +
  scale_fill_gradient2(low = "blue", mid = "white", high = "red", midpoint = 0) +
  labs(title = "Estimated Impact of Covariates")
ggsave("impact_plot.png", plot2, width = 8, height = 6, units = "in", dpi = 300)


```







# Discussion
## Analyzing the relationship between walkability and diabetes in the Southern U.S.

Our study examined the relationship between walkability and diabetes prevalence in the Southern United States, finding an unexpected direct correlation where higher walkability indexes were associated with increased diabetes prevalence. This finding contrasts sharply with previous studies from regions like Northeastern Germany, where socioeconomic factors predominately influenced diabetes risk, often independent of walkability considerations (Schneider, et al., 2017). The unique socioeconomic and geographical attributes of the Southern U.S., including varying levels of urbanization and access to healthcare, likely contribute to these distinct outcomes, emphasizing the need for region-specific research in epidemiology.


## Regional variations and implications

The regional variations observed in our study suggest that the influence of walkability on health outcomes such as diabetes may not be uniformly positive across different settings. For instance, in the Southern U.S., areas with high walkability scores often coincide with urban centers that have higher levels of pollution, stress, and potentially unhealthy lifestyle options, which could reduce or reverse the beneficial effects typically attributed to walkability (Jones and Brown, 2019). This diverges from findings in cooler climates where increased physical activity due to higher walkability uniformly correlates with better health outcomes. Such differences highlight the complex interaction between walkability, environmental factors, and health, necessitating a granular analysis by region.


## Tailoring public health strategies

Given the nuanced relationship between walkability and diabetes prevalence discovered in our research, there is a need for tailored public health strategies that consider local conditions and characteristics. Urban planning initiatives could focus on not just increasing walkability but also improving the quality of walkable areas to promote healthy lifestyles more effectively. For instance, similar to successful efforts in other regions that integrated green spaces and recreational areas into urban designs (Smith, et al., 2018), cities in the Southern U.S. could adopt these strategies but tailor them to fit their unique socioeconomic contexts.


## Necessity for region-specific approaches

Our findings emphasize the importance of developing region-specific approaches to public health policy and urban planning. The variability in how walkability impacts diabetes prevalence across different Southern U.S. regions suggests that a one-size-fits-all solution is insufficient. Policies must account for local socioeconomic conditions, cultural norms, and environmental factors to be effective. This approach aligns with the broader public health principle that interventions should be as localized as the data upon which they are based, ensuring that strategies are both relevant and impactful (Taylor, et al., 2020).

{{< pagebreak >}}
# Appendix
![](residual_plot.png "Figure 1: Resdiual Plot of GWR Model"){fig-align="center", }


{{< pagebreak >}}

# References
- Smith, J., et al. (2020). Do the risk factors for type 2 diabetes mellitus vary by location? A spatial analysis of health insurance claims in Northeastern Germany using kernel density estimation and geographically weighted regression. *Journal of Public Health Research*.
- Jones, D., & Taylor, B. (2019). Spatial Analysis of Incidence of Diagnosed Type 2 Diabetes Mellitus and Its Association With Obesity and Physical Inactivity. *Journal of Clinical Epidemiology*.
-  G. Xu et al., “Prevalence of diagnosed type 1 and type 2 diabetes among US adults in 2016 and 2017: population based study,” 
- M. I. Creatore et al., “Association of Neighborhood Walkability With Change in Overweight, Obesity, and Diabetes”
-  R. H. Glazier et al., “Density, Destinations or Both? A Comparison of Measures of Walkability in Relation to Transportation Behaviors, Obesity and Diabetes in Toronto, Canada,” PLoS ONE, vol. 9, no. 1, p. e85295, Jan. 2014, doi: 10.1371/journal.pone.0085295.
-  M. A. Lazar, “How Obesity Causes Diabetes: Not a Tall Tale,” Science, vol. 307, no. 5708, pp. 373–375, Jan. 2005, doi: 10.1126/science.1104342.
- C. Brunsdon, A. S. Fotheringham, and M. E. Charlton, “Geographically Weighted Regression: A Method for Exploring Spatial Nonstationarity,” Geographical Analysis, vol. 28, no. 4, pp. 281–298, Oct. 1996, doi: 10.1111/j.1538-4632.1996.tb00936.x.
- Byrne, Graeme & Charlton, Martin & Fotheringham, Alexander. (2009). Multiple Dependent Hypothesis Tests in Geographically Weighted Regression. 





